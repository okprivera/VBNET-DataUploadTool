USE master
IF EXISTS(select * from sys.databases where name='PracticalTest')
DROP DATABASE PracticalTest


-- create the database
CREATE DATABASE PracticalTest
GO

-- switch to it
USE PracticalTest
GO

CREATE TABLE DBO.TBLCLIENT (
	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	STRFIRST_NAME NVARCHAR(255),
	STRLAST_NAME NVARCHAR(255),
	STRCOMPANY_NAME NVARCHAR(255),
	STRADDRESS NVARCHAR(255),
	STRCITY NVARCHAR(255),
	STRSTATE NVARCHAR(255),
	STRPOST NVARCHAR(255),
	STRPHONE1 NVARCHAR(255),
	STRPHONE2 NVARCHAR(255),	
	STREMAIL NVARCHAR(255),	
	STRWEB NVARCHAR(255),
)
GO

CREATE NONCLUSTERED INDEX IDX_STRFIRST_NAME
ON TBLCLIENT (STRFIRST_NAME);
GO

CREATE NONCLUSTERED INDEX IDX_STRLAST_NAME
ON TBLCLIENT (STRLAST_NAME);
GO

CREATE NONCLUSTERED INDEX IDX_EMAIL
ON TBLCLIENT (STREMAIL);
GO

CREATE NONCLUSTERED INDEX IDX_PHONE1
ON TBLCLIENT (STRPHONE1);
GO


--INSERTION OF STORED PROCEDURE TO UPLOAD FOR DATA
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'SP_INSERTDATA') AND type in (N'P', N'PC'))
  DROP PROCEDURE [dbo].[SP_INSERTDATA]
GO

CREATE PROCEDURE SP_INSERTDATA (@FIRST_NAME AS NVARCHAR(255),@LAST_NAME AS NVARCHAR(255),@COMPANY_NAME AS NVARCHAR(255),@ADDRESS AS NVARCHAR(255),@CITY AS NVARCHAR(255),@STATE AS NVARCHAR(255),@POST AS NVARCHAR(255),@PHONE1 AS NVARCHAR(255),@PHONE2 AS NVARCHAR(255),@EMAIL AS NVARCHAR(255),@WEB AS NVARCHAR(255))
AS
BEGIN

INSERT INTO TBLCLIENT (STRFIRST_NAME,STRLAST_NAME,STRCOMPANY_NAME,STRADDRESS,STRCITY,STRSTATE,STRPOST,STRPHONE1,STRPHONE2,STREMAIL,STRWEB)
VALUES (@FIRST_NAME,@LAST_NAME,@COMPANY_NAME,@ADDRESS,@CITY,@STATE,@POST,@PHONE1,@PHONE2,@EMAIL,@WEB)

END
GO



--INSERTION OF STORED PROCEDURE TO SEARCH FOR DATA
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'SP_SEARCH') AND type in (N'P', N'PC'))
  DROP PROCEDURE [dbo].[SP_SEARCH]
GO

CREATE PROCEDURE [dbo].[SP_SEARCH] (@SRCH AS NVARCHAR(255))
AS
BEGIN

SELECT DISTINCT STRFIRST_NAME AS [FIRST NAME],STRLAST_NAME AS [LAST NAME],STREMAIL AS [EMAIL],STRPHONE1 AS [CONTACT] FROM TBLCLIENT
	WHERE	STRFIRST_NAME LIKE '%' + @SRCH + '%'
			OR STRLAST_NAME LIKE '%' + @SRCH + '%'
			OR STREMAIL LIKE '%' + @SRCH + '%'
			OR STRPHONE1 LIKE '%' + @SRCH + '%'

END
GO